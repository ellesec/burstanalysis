\documentclass[12pt, titlepage]{article}
\usepackage[a4paper,margin=2.2cm]{geometry}
\usepackage{graphicx}
\usepackage{mathpazo}
\usepackage{tabularx}
\usepackage[table]{xcolor}  
\usepackage{xparse}
\definecolor{Gray}{gray}{0.85}
\usepackage{amssymb}
\usepackage{color, colortbl}
\usepackage{authblk}
\usepackage{jneurosci}	
\usepackage{url}
\usepackage{tocloft}
\usepackage{lineno}
\linenumbers


\cftpagenumbersoff{figure}
\cftpagenumbersoff{table}


\renewcommand{\baselinestretch}{1.66}
\begin{document}
	\begin{titlepage}
	
		\begin{center}
	
			{\LARGE   A comparison of computational methods for detecting bursts in neuronal spike trains and their application to human stem cell-derived neuronal networks}
			\\ \bigskip {\large Abbrev title: Comparison of burst detectors for spike trains
			\bigskip \\  Ellese Cotterill$^{1^*}$, Paul Charlesworth$^2$, Christopher W. Thomas$^{2,3}$,\\Ole Paulsen$^2$, Stephen J. Eglen$^1$
		}
			\end{center}
		\noindent$^1$Cambridge Computational Biology Institute, University of Cambridge, Wilberforce Road, Cambridge, CB3 0WA, UK
		\\$^2$Department of Physiology, Development and Neuroscience, Physiological Laboratory, Downing Street, Cambridge, CB2 3EG, UK
                \\$^3$Current address: Department of Physiology, Anatomy and Genetics, 
University of Oxford, Oxford, OX1 3QX, UK
		\\$^*$Correspondence: Ellese Cotterill, University of Cambridge, Wilberforce Road, Cambridge,
		CB3 0WA, UK. E-mail: ec526@cam.ac.uk.
		\bigskip \\ \textbf{Conflict of Interest:} The authors declare no competing financial interests.
		\bigskip \\ \textbf{Acknowledgements:} Experimental data collection was supported by the BBSRC (PC, OP, grant number BB/H008608/1). EC was supported by a Wellcome Trust PhD Studentship and NIHR Cambridge Biomedical Research Centre Studentship.  CWT was supported by a bursary from the Bridgwater Summer Undergraduate Research programme. We thank Tokdar et al., Pasquale et al., Ko et al. and Gour\'{e}vitch et al. for code used in this study and Matthias Hennig, Timothy Shafer, Diana Hall and Catherine Cutts for comments on the manuscript. 
		%\bigskip \\ \textbf{Author Contributions:} EC, PC, OP and SJE designed research, EC and PC performed research, EC analysed data, EC, CWT and SJE contributed unpublished reagents/analytic tools, EC, PC and SJE wrote the paper.
	\\ \begin{tabular}{m{8cm}l}\\\textbf{Number of Figures:} 8
		 &  \textbf{Number of Tables:} 6
		\\ \textbf{Abstract word count:} 235
		 &  \textbf{Introduction word count:} 644
		\\ \textbf{Discussion word count:} 1492
		\end{tabular}
	
		
	\end{titlepage} 
	\subsection*{Abbreviations}
	\begin{tabular}{llll}
		\hline
		CMA & Cumulative moving average & MI & MaxInterval
		\\CV & Coefficient of variation & NM & Neural Maintenance 	
		\\hiPSC & Human induced pluripotent stem cell & PS &  Poisson surprise								 
		\\HSMM &  Hidden semi-Markov model \ \ \ &  RGC & Retinal ganglion cell
		\\ IBI &  Interburst interval& RGS & Robust Gaussian surprise
		\\IRT & ISI rank threshold & ROC & Receiver operating characteristic
		\\ ISI & Interspike interval & RS & Rank surprise
		\\ MCMC & Markov chain Monte Carlo &  WAP & Weeks after plating
		\\  MEA & Microelectrode array
		\\ \hline
	\end{tabular}

	\section*{ABSTRACT}
	Accurate identification of bursting activity is an essential element in the characterisation of neuronal network activity. Despite this, no one technique for identifying bursts in spike trains has been widely adopted. Instead, many methods have been developed for the analysis of bursting activity, often on an ad hoc basis. Here, we provide an unbiased assessment of the effectiveness of eight of these methods at detecting bursts in a range of spike trains. We suggest a list of features that an ideal burst detection technique should possess, and use synthetic data to assess each method in regards to these properties. We further employ each of the methods to re-analyse microelectrode array (MEA) recordings from mouse retinal ganglion cells, and examine their coherence with bursts detected by a human observer. We show that several common burst detection techniques perform poorly at analysing spike trains with a variety of properties. We identify four promising burst detection techniques, which are then applied to MEA recordings of networks of human induced pluripotent stem cell-derived neurons, and used to describe the ontogeny of bursting activity in these networks over several months of development. We conclude that no current method can provide `perfect' burst detection results across a range of spike trains, however two burst detection techniques, the MaxInterval and logISI methods, outperform compared to others. We provide recommendations for the robust analysis of bursting activity in experimental recordings using current techniques.
	\section*{SIGNIFICANCE STATEMENT}
	Analysis of patterns of neuronal bursting is an important aspect in many studies of neuronal network activity. Many methods have been previously proposed for identifying bursts in neuronal spike trains. These methods take a range of different approaches, making cross-study comparisons challenging. Here, we provide an unbiased quantitative assessment of eight existing burst detectors, using both synthetic and experimental data. We reveal limitations in a number of commonly used burst detection techniques and provide recommendations for the best practice for accurate identification of bursts using existing techniques. 
	\section*{INTRODUCTION}
	The tendency of neurons to fire brief periods of spikes in quick succession, or bursts, has been observed extensively both \textit{in vitro} and \textit{in vivo} \cite{Weyand2001,Pasquale2010}. Bursting is believed to be associated with a variety of physiological processes, such as synapse formation \cite{Maeda1995} and long-term potentiation \cite{Lisman1997}. Using recordings of the electrical activity of neurons cultured on microelectrode arrays (MEAs), various aspects of \textit{in vitro} network activity, including bursting, can be readily examined. MEAs have thus been used to study changes in the spontaneous activity patterns exhibited by neuronal networks over development \cite{Wagenaar2006,Charlesworth2015}. Analysis of bursting activity has also been used as an important tool in applications such as studying the impact of genetic or chemical manipulations on network activity \cite{Eisenman2015,Charlesworth2016}. 
	\\ \\ Despite the prevalence of bursting as a feature used to study neuronal network activity, the concept of a burst still lacks a definitive formal definition \cite{Cocatre-Zilgien1992,Gourevitch2007} or single widespread technique used for detecting bursts. Instead, a variety of burst detectors exist, many of which have been developed and verified by researchers on an ad hoc basis using specific data sets and singular experimental conditions. 
	\\\\One common approach to burst detection is to identify periods of bursting using simple thresholds, which impose limits on values such as the minimum firing rate or maximum allowed interspike interval (ISI) in a burst. These thresholds can either be fixed values  \cite{Chiappalone2005,Mukai2003},  or derived from properties of the spike trains, such as the mean ISI \cite{Chen2009}, total spiking rate \cite{Pimashkin2011} or some form of the distribution of ISIs or discharge density 
	\cite{Cocatre-Zilgien1992,Selinger2007,Pasquale2010,Kaneoke1996,Bakkum2013,Kapucu2012}.
	 Another type of burst detection techniques are the 'surprise-based' methods, which detect bursts as deviations from an assumed underlying firing rate distribution \cite{Legendy1985,Ko2012,Gourevitch2007}. There are also a variety of methods based on some variation of these ideas, or which take other approaches entirely \cite{Hennig2011,Tokdar2010,Turnbull2005,Tam2002,Xia2003,Wagenaar2005,Weihberger2013}.
	\\ \\ Most existing studies involving analysis of bursting activity in MEA recordings have been performed on experimental data from rodent nervous systems \cite{Charlesworth2015,Mazzoni2007}. In recent years, it has been demonstrated that networks of neurons derived from human stem cells can be grown successfully on MEAs, and exhibit spontaneous electrical activity, including bursting behaviour \cite{Odawara2016856,Heikkila2009}. %The suitability of these networks for applications such as neurotoxicity testing has also been demonstrated \cite{Yla-Outinen2010}. 
	These networks often exhibit far more variable bursting activity than more commonly studied rodent neuronal networks \cite{Kapucu2012}.
	There is thus a demand for the development of robust standardized analysis methods for identifying bursts in such networks.
	\\ \\ Here, we have reviewed eight existing burst detectors, selected to encompass a range of contemporary burst analysis methods, and evaluated their effectiveness at detecting bursts, particularly in spike trains with properties resembling those of human stem cell-derived neuronal networks. Each burst detector was used to analyse bursts in both synthetic spike trains, as well as \textit{in vitro} MEA recordings from mouse retinal ganglion cells (RGCs). This allowed for a quantitative assessment of the performance of each method in a variety of contexts. Based on these results, we offer suggestions to researchers regarding the best approaches for comprehensive burst analysis. The highest performing methods in our study were also employed to describe the ontogeny of bursting activity in networks of human induced pluripotent stem cell (hiPSC)-derived neurons over several months of development. 
	\section*{MATERIALS AND METHODS}
	\subsection*{Burst analysis methods}
	Eight burst detectors that we believed to be representative of the major approaches to burst detection and that have sufficient general applicability to allow for their use on a variety of spike trains were chosen for analysis. Other methods were excluded from the analysis for a variety of reasons, including that they do not explicitly identify the location of bursts in a spike train \cite{VanElburg2004}, or we believe that they have been superseded by other methods that were adapted from them \cite{Selinger2007,Chiappalone2005}. 
	\\ \\ A brief description of each of the eight burst detectors applied to a single spike train is given below, and we refer the reader to the original sources for more detailed descriptions. Where possible, we reused existing code from the original authors to implement each method. The code used to implement each method is publicly available at \url{https://github.com/ellesec/burstanalysis}.\\ \\ In the implementation of each of the methods, the minimum number of spikes in a burst was set to three and other parameters were left set to the standard parameters suggested by the authors, shown in Table \ref{param_vals}. The exception to this was the three surprise-based burst detectors, for which the minimum surprise value was set to $-\log(0.01)$ for all three methods, to ensure consistency across these burst detectors.
	\\ \\ \textit{LogISI method \cite{Pasquale2010}} 
	\\Bursts are detected using the histogram of the log adjusted interspike intervals (ISIs) on a spike train. The peaks of this histogram are found using a tailor-made peak finding algorithm outlined in \citetext{Pasquale2010}, and the largest peak corresponding to an ISI of $100\,$ms or less is set as the intra-burst peak. In the absence of such a peak, no bursts are found. The minimum values between the intra-burst peak and all subsequent peaks are found, and a void parameter, which represents how well the peaks are separated, is calculated for each minima. The ISI value corresponding to the first minimum at which the void parameter exceeds a threshold value of 0.7 is set as the cutoff value for burst detection, $maxISI$.  Bursts are then detected as any series of three or more spikes separated by ISIs smaller than $maxISI$. If no cutoff is found, or if $maxISI>100\,$ms, bursts are found using a $100\,$ms cutoff, and then extended to include any spikes within $maxISI$ of the edges of each burst.
	\\ \\ \textit{Cumulative Moving Average (CMA) method \cite{Kapucu2012}} 
	\\The cumulative moving average (CMA) of the histogram of ISIs is calculated. The skewness of this CMA distribution is used to determine the values of two parameters, $\alpha_1$ and $\alpha_2$,  according to the scale given in \citetext{Kapucu2012} and shown in Table \ref{param_vals}. The ISI value of the histogram bin at which the CMA is closest in value to $\alpha_1 \cdot CMA_{MAX}$ is set as $maxISI$, where $CMA_{MAX}$ is the peak of the CMA distribution. Again, bursts are defined as sequences of more than two spikes separated by ISIs less than $maxISI$.
	\\ \\ \citetext{Kapucu2012} also suggest expanding these bursts to include burst related spikes, which are found using a cutoff set at the histogram bin at which the CMA is closest to $\alpha_2 \cdot CMA_{MAX}$. Any spikes within this cutoff distance from the beginning or end of the original bursts are classified as burst related spikes. However, for our purposes, we only examined the original burst cores detected from this method, and omitted any burst related spikes.
	\\ \\ \textit{ISI Rank Threshold (IRT) method \cite{Hennig2011}}
	\\The rank, $R(t)$, of each ISI relative to the largest ISI on the spike train is calculated. A rank cutoff, $\theta_R$, is chosen, and a spike count cutoff, $\theta_C$, is calculated from the distribution of spike counts over one second intervals on the spike train. A burst begins at a time $t$ if the spike count over the following second exceeds $\theta_C$, and its subsequent ISI satisfies $R(t)<\theta_R$. The burst continues until the spike count over the proceeding one second interval falls below $\frac{\theta_C}{2}$.
	\\ \\ \textit{Poisson Surprise (PS) method \cite{Legendy1985}}
	\\The baseline firing rate on a spike train is assumed to follow a Poisson process with rate $\lambda$ equal to the mean firing rate over the entire train. The Poisson surprise statistic for an interval of length $T$ containing $N$ spikes is defined as 
	\[S = -\log(p)\] 
	where $p$ is the probability of $N$ or more spikes randomly occurring in an interval of length $T$ in the underlying Poisson process. Bursts are chosen so as to maximise the Poisson surprise statistic over the entire spike train using a surprise maximisation algorithm outlined in \citetext{Legendy1985}, and any bursts with a Poisson surprise value below a threshold significance level are discarded. In our implementation, the cutoff significance level was reduced from the value of ten, used in \citetext{Legendy1985}, to a value of $-\log(0.01)\approx 4.6$, to bring it in line with the other surprise-based methods.
	\\ \\ \textit{Rank Surprise (RS) method \cite{Gourevitch2007}}
	\\The ISIs on the spike train are ranked,  with the smallest ISI given a rank of 1. For each possible bursting interval, the rank of all ISIs on the interval are summed, and the probability, $p$, of a value of equal or lesser value  being drawn randomly from a discrete uniform sum distribution is calculated. Bursts are chosen so as to maximise the rank surprise statistic, defined as $RS=-\log(p)$, across the entire spike train, and any bursts with a rank surprise statistic below a pre-defined significance threshold are discarded\nocite{Gourevitch2007}. 
	\\ \\ \textit{Robust Gaussian Surprise (RGS) method \cite{Ko2012}}
	\\Bursts are regarded as outliers from a ``central distribution'' of ISIs, which is estimated from the distribution of normalised $\log(ISIs)$ in a spike train. ISIs are considered to be potentially within bursts if they lie below -2.58 times the median absolute deviation of this distribution. For each potential burst, the Robust Gaussian Burst Surprise value, $GS_B=-\log(p)$, is calculated, where $p$ is the probability that the sum of the normalized $\log(ISIs)$ in the interval is less than or equal to the sum of an equivalent number of i.i.d. Gaussian random variables with mean and standard deviation equal to those of the central distribution. These initial bursts are then extended to include surrounding spikes until the maximal surprise value is found. Finally, any bursts with a surprise value below a pre-defined significance threshold are discarded.
	\\ \\ \textit{Hidden Semi-Markov Model (HSMM) method \cite{Tokdar2010}}
	\\Neurons are assumed to stochastically alternate between a ``non-bursting'' and ``bursting'' state, labelled states 0 and 1 respectively. Spiking activity is modelled using a hidden semi-Markov model, with transition times between the two states modelled as two Gamma distributions,  $f_0^{ITI}$ and $f_1^{ITI}$.  Within each of the two states, the distribution of ISIs are modelled using two additional Gamma distributions, $f_0^{ISI}$ and $f_1^{ISI}$. The parameters of these four distributions are learned from the data. Under these assumptions, the posterior probability that the neuron is in a bursting state at any given time is calculated using a Markov chain Monte Carlo (MCMC) method, and any periods in which this probability exceeds a threshold value are classified as bursts. An R package to implement this method is available at \url{https://stat.duke.edu/~st118/Software/}.
	\\ \\ \textit{MaxInterval (MI) method  \cite{NEmanual}}
	\\Any series of consecutive spikes fulfilling five threshold parameters, the value of which are chosen by the user, are classified as bursts. For our purposes, the values of the parameters were those specified in the NeuroExplorer Manual \cite{NEmanual}, and shown in Table \ref{param_vals}.
	\subsection*{Analysis of synthetic data}
	The performance of each method was evaluated against a list of properties that we deemed desirable in a burst detector, shown in Table \ref{des_prop}. For properties D1--D3, performance was based on the details of the method's implementation, while for the remaining properties (D4--D10), testing on simulated data was performed. Simulated data was used for this purpose because it allowed us to generate spike trains with specific properties of interest. By explicitly generating periods of bursting activity in these spike trains, we were also able to compare the results of each burst detector with the 'ground truth' bursting behaviour. Simulated spike trains were produced using the models outlined below, with the parameter values specified in Table \ref{sim_params}.
	\\\\ 	\textit{Poisson and Gamma distributions}
	\\Two types of non-bursting spike trains were simulated, one with Poisson distributed ISIs, and the other with Gamma distributed ISIs. The smallest 10th percentile of ISIs were removed from each spike train by omitting the corresponding spikes, to eliminate any burst-like behaviour arising randomly in the simulated data.
	\\ \\  \textit{Inhomogeneous Poisson distribution}
	\\ Spike trains with non-stationary firing rates and no bursts were simulated using a Poisson process with non-homogeneous intensity, $\lambda(t)$. To eliminate any possible bursting behaviour, spikes corresponding to the smallest 10th percentile of ISIs were removed from each spike train.
	\\ \\  \textit{Poisson Bursting}
	\\ Bursting spike trains were simulated using the Poisson bursting model. The location of the centre of each burst on a spike train was modelled using a Poisson process with a fixed rate, $\lambda$. The number of spikes in each of the bursts was drawn from a Poisson distribution with mean $n$. The position of the spikes in each burst relative to the burst centre were drawn from a uniform distribution with range $r$ and mean 0. Where two bursts overlapped, only the first was kept. 
	\\ \\ To simulate noise in bursting spike trains, noise spikes were modelled with Gamma distributed ISIs with the smallest 10th percentile of ISIs removed. These noise spikes were added to the Poisson bursting spike train and any noise spikes within $0.5 \,$s of the limits of each burst were removed, to prevent any overlap between burst and noise spikes.
	\\ \\ For each desirable property, one hundred spike trains of duration 300$\,$s were simulated and analysed using each of the burst detectors detailed above. Examples of the simulated spike trains used for evaluating each desirable property are shown in Figure \ref{sim_egs}. A comparison of the `ground truth' bursting activity and the results from each burst detector was then performed. 
	\subsection*{Analysis of mouse RGC data}
	MEA recordings of mouse retinal ganglion cells (RGCs) from \citetext{Demas2003} were re-analysed using the burst detectors in our study. These MEA recordings are available from \citetext{Eglen2014a}. Four hour-long recordings of  control mice retina at postnatal days 9, 11, 13 and 15 were chosen for re-analysis. For spike trains from five randomly chosen electrodes from each recording, bursts were annotated by visual inspection by one of the authors (EC). Examples of annotated bursts for spike trains at each age are shown in Figure \ref{RGC_eg}. As MEA recordings do not provide the 'ground truth' location of bursts, these visually identified bursts were taken as a proxy for 'ground truth' bursts and used to compare the results from each burst detector against. Comparison to visually identified bursts has been used previously to assess burst detection techniques \cite{Chen2009,Gourevitch2007,Pasquale2010}. For each burst detector in our study, bursts were detected on the annotated spike trains using a variety of input parameters, and the sensitivity and specificity of each method examined.
	\\ \\To assess their robustness, we chose a key parameter to vary for each burst detector. The parameter that was varied to examine the sensitivity and specificity of the HSMM and surprise-based methods was the probability cutoff, while for the IRT method, the spike count cutoff, $\theta_C$, was altered. For the logISI method, the limit on the maximum allowed ISI cutoff value was varied from its initial value of 100$\,$ms. For the MI method, most parameter values shown in Table \ref{param_vals} were maintained, excluding the maximum beginning and end ISIs, which were varied so that the maximum end ISI was always 0.130$\,$s greater than the maximum beginning ISI. Finally, for the CMA method, for which there were no obvious parameters to vary, only a single value for sensitivity and specificity was found.
	\\ \\ Receiver operating characteristic (ROC) curves were produced that plotted 1-specificity versus sensitivity for various parameter values. Sensitivity was defined as the number of spikes correctly detected as being within bursts, as a fraction of the total number of spikes in the visually annotated bursts. The value of 1-specificity, or the false positive rate, was the number of spikes that were falsely detected as being within bursts, as a fraction of the total number of spikes that were not a part of the `ground truth' bursts. 
	\subsection*{Experimental details for hiPSC derived neural network recordings}
Neuronal networks were grown from late stage neuronal precursors differentiated from human induced pluripotent stem cells (hiPSCs) (Axol Bioscience, Moneta Building, Babraham Research Campus, Cambridge). hiPSCs were generated by reprogramming of embryonic cord blood cells and then differentiated to the neural lineage using protocols based on those in \citetext{Shi2012}. All of the recordings (447 recordings from 73 MEA platings on 11 plating dates, 4 thawed vials) were obtained using a single line and neural induction (AX0015, \url{http://www.axolbio.com/page/neural-stem-cells-cerebral-cortex}).
\\ \\Late stage neuronal precursors ($1\times 10^6$) were thawed and expanded by growing on 6 well tissue culture plates coated with polyornithine and laminin ($2\times 10^5$ cells/well) in `Neural Maintenance' (NM) medium, supplemented with $10\,\mu$M Y-27632 (rho-associated protein kinase inhibitor) for the first 24 hours. After 4--5 days cells were dissociated with Accutase, centrifuged, resuspended in NM and either plated to MEAs ($2\times 10^4-1\times 10^5$), or expanded further on six-well plates as above. MEAs (60MEA200/30-Ti, Multi Channel Systems, Reutlingen, Germany) were coated with polylysine followed by laminin as described previously \cite{Charlesworth2016}.
\\ \\hiPSN--MEA cultures were maintained in NM medium under zero evaporation lids \cite{Potter2001} housed in tissue culture incubators maintained humidified at 37$^{\circ}$C and 5\% CO$_2$ / 10\%  O$_2$  / 85\% N$_2$. Media was completely exchanged after 24 hours to remove Y-27632. Thereafter, MEA cultures were fed by exchanging 40--50\% medium with fresh NM three times per week. NM media composition was a 1:1 mixture of N2 and B27 supplemented media. N2 media: DMEM/F12 + N2 supplement and 5$\,\mu$g ml$^{-1}$ insulin, 1mM l-glutamine, 100$\,\mu$M nonessential amino acids. B27 media: Neurobasal + B27 supplement and 0.5 mM l-glutamine.
\\ \\ Recordings ($300$\,s) of spontaneous extracellular neuronal activity in hiPSN-MEA cultures were made weekly using an MEA system supplied by Multi Channel Systems (MEA 1060INV, with 60MEA200/30-Ti arrays; titanium nitride electrodes, $30\,\mu$m diameter, $200\,\mu$m spacing, internal reference electrode). The signal was sampled at $25\,$kHz and stored using a 64-channel data acquisition board (MC Card; Multi Channel Systems) and the acquisition software MCRack (Multi Channel Systems). Action potentials were detected by crossing of a threshold set to a level of 6 standard deviations from the baseline noise level. Record samples ($1\,$ms pre- and $2\,$ms post-crossing of threshold) confirmed the characteristic action potential waveform. Action potential timestamps were extracted to text file using batch scripts written for NeuroExplorer (Nex Technologies, Littleton, MA). Recordings made at dates above fifteen weeks after plating were excluded from the analysis due to the small number of data points, resulting in a total of 409 recordings included in the analysis.
	\section*{RESULTS}
	\subsection*{Desirable properties for a burst detector}
	To evaluate the performance of each burst detector, the methods were assessed against ten desirable properties, listed in Table \ref{des_prop}. The optimal burst detector would ideally possess all of these desirable properties. For binary properties, D1--D4, each method was judged to either possess the property or not, while for properties D5--D10, the performance of each method was ranked against the other methods, based on the median and variance of its performance at analysing one hundred synthetic spike trains. 
	\\ \\ The first desirable property of a burst detector was that it was deterministic (D1), as this ensures reproducibility and removes the need to find a `consensus' set of bursts across repeated trials. The only non-deterministic burst detector was the HSMM method, due to its use of MCMC methods. The bursts detected by this method varied considerably between trials. For example, with repeated analysis of a simulated $300\,$s Poisson bursting spike train with burst frequency of 0.2$\,$Hz by the HSMM method, the number of bursts detected on the spike train varied from 2 to 56 bursts over one hundred trials. 
	\\ \\ Another desirable property for the burst detectors was that they did not assume that ISIs in a spike train follow a specific statistical distribution (D2). There is no consensus on which type of statistical distribution best represents underlying spike train activity, and any assumption that this activity follows a fixed statistical distribution restricts the applicability of a method to a narrow range of spike trains. Most methods do not assume a fixed statistical distribution for the underlying spike train, excluding the PS, RGS and HSMM methods, which assume that ISIs can be modelled using a Poisson process, Gaussian distribution and Gamma distributions respectively. However, the PS and RGS methods detect bursts as periods of deviation from these underlying firing rate distributions.
	These methods thus remain somewhat robust when the distribution assumptions are not met, as `surprising' sequences of spikes as measured by one distribution will generally also correspond to high surprise values from other distributions commonly used to model spike trains \cite{Legendy1985}. 
	\\ \\ A common issue that arises when applying burst detection techniques to large sets of spike trains that have high variability in their statistical properties, such as those obtained from MEA recordings of human neuronal networks, is how to accurately choose the parameters for burst detection. This is further confounded when burst detectors are used to analyse MEA recordings spanning a large range of developmental ages, or differing experimental conditions. Thus, ideally, a burst detector should have a small number of parameters (D3), to minimise the impact of how parameter values affect the resultant detected bursts. Most methods in our study only required one or two parameters. The MI method, on the other hand, required five parameters to implement burst detection. The HSMM method also required a large number (N=23) of parameters to fit the hidden semi-Markov model to the data. However, many of these are initial values that are later optimised by the algorithm, and can be left set to the values suggested by the original authors with little impact on the effectiveness of the method. 
	\\ \\ With the increasing prevalence of high density MEAs that contain up to several thousand electrodes \cite{Maccione2014}, as well as the use of multi-well MEAs in applications such as high-throughput neurotoxicology screening \cite{Valdivia2014,Nicolas2014} and drug safety testing \cite{Gilchrist2015}, the computational complexity of each method must also be considered. To assess computational time (D4), each method was used to analyse one hundred simulated spike trains of five minutes duration with average firing rate of 1$\,$Hz. Most methods required on average only a fraction of a second to analyse each spike train using a standard personal computer. The exception to this was the HSMM method, which had an average computational time more than 20 times greater than any of the other methods. 
	\\ \\ A common feature seen in MEA recordings of human neuronal networks is many electrodes that record sparse or no bursting behaviour, with either relatively stationary or quite variable firing rates over the course of the recording. An ideal burst detector would find no or very little bursting activity in these spike trains. Most burst detectors performed reasonably well at detecting a low amount of bursting activity in spike trains simulated to exhibit an absence of bursting behaviour (D5). The major exception to this was the HSMM method, which had a tendency to significantly overestimate bursting behaviour in these spike trains (Figure \ref{sim_results1}A). 
	\\ \\ When a non-stationary firing rate was incorporated into non-bursting spike trains (D6), the number of erroneous bursts detected by most methods increased (Figure \ref{sim_results1}B). The PS and CMA methods, in particular, showed a significant increase in the amount of bursting activity detected in non-stationary spike trains, compared to those with a static mean firing rate. These methods tends to detect periods of 'unusual' activity as bursts, and thus showed a tendency to detect bursts in the regions of relatively high firing rate in these spike trains. 
	\\ \\ An ideal burst detector should also detect bursts accurately in spike trains that contain only bursting activity, especially those in which the bursts are regular and well separated (D7). Most methods possessed this property, and could identify over 90\% of the spikes within bursts in simulated spike trains containing regular bursting behaviour (Figure \ref{sim_results1}C). The exceptions to this were the RS, IRT and RGS methods, which consistently detected less than half of the bursts in these synthetic spike trains. This result is unsurprising, since these three methods use thresholds that impose a limit on the maximum proportion of ISIs in a spike train that can be classified as being within bursts.
	\\ \\ We also analysed the performance of each burst detector on simulated spike trains with less standard bursting behaviour. This included  spike trains containing bursts with long durations and relatively low within-burst firing rates (D8). For these spike trains, only the PS and HSMM methods gave reasonably accurate results for both the fraction of spikes in bursts and the number of bursts in the spike trains (Figure \ref{sim_results2}A,B). The MI and CMA methods both correctly allocated a large proportion of the spikes as being within bursts, but had a tendency to separate long bursts into shorter, more frequent bursts, while the remaining methods greatly underestimated the prevalence of bursting activity in the simulated data (Figure \ref{sim_results2}A,B).
	\\ \\ Another type of non-standard bursting activity seen in human network recordings is the presence of short, poorly separated bursts occurring at a high frequency. When used to analyse spike trains with very frequent bursting behaviour (D9), the MI, logISI and HSMM methods could correctly identify the majority of spikes as being within bursts, but had a tendency to combine the short bursts into a smaller number of bursts with longer durations (Figure \ref{sim_results2}C,D). The CMA method most accurately detected the large number of bursts in these high frequency spike trains, but had a tendency to underestimate the proportion of spikes in bursts. The RS, IRT and RGS methods, on the other hand, were only able to identify a low fraction of bursting spikes and low number of bursts in these spike trains (Figure \ref{sim_results2}C,D).
	\\ \\ Finally, an ideal burst detector should correctly differentiate between bursting and non-bursting periods in spike trains in which some spiking activity occurs outside of bursts (D10). By comparing each method's output to the ground truth bursting behaviour in simulated spike trains containing both bursts and noise, we examined the fraction of spikes that were correctly identified as being within bursts, as well as the fraction of between-burst, or noise spikes, that were erroneously detected as being within bursts by each burst detector.
	The MI, CMA, logISI and HSMM methods displayed reasonably high true positive rates for identifying bursting spikes, however, of these, the logISI and HSMM methods tended to classify a higher proportion of noise spikes as being within bursts (Figure \ref{sim_results2}E,F). The RS, IRT and RGS methods exhibited very low false positive rates, but this came at the expense of quite low true positive rates, giving them low overall recall. The performance of the PS method was between these two extremes, with both lower true positive and false positive rates than the highest performing burst detectors.
	\\ \\ The performance of each of the burst detectors across all desirable properties is summarised in Tables \ref{des_results1} and \ref{des_results2}. The ranking in Table \ref{des_results2} was based on the median and range of the boxplots in Figures \ref{sim_results1} and \ref{sim_results2}, with methods with similar results given equal rankings. Three methods clearly underperformed based on this ranking, namely the RS, IRT and RGS methods. To further assess the performance of the burst detectors, they were each used to analyse bursting activity in experimental recordings from mouse RGCs.
	% Based on the properties D1-D4 in Table 1, the HSMM method has the worst performance in terms of its computational complexity and underlying assumptions. For the desirable properties requiring testing on simulated data in Table 2, however, it is the RS, IRT and RGS methods that significantly underperform the other methods. 
	\subsection*{Preliminary analysis of mouse RGC data}
	MEA recordings of mouse RGCs from \citetext{Demas2003}, a study which examined the changes in spontaneous retinal activity in both normal and dark-reared mice over development, were re-analysed using the burst detectors in our study. The sensitivity and specificity of each burst detector at a range of parameter values was found using the approach outlined in the methods, and averaged across the five annotated spike trains from each recording, to produce the ROC curves for each age shown in Figure \ref{ROC}. 
	Because of innate restrictions on how bursts are defined by each method, for example that bursts must contain a minimum of three spikes, many burst detectors did not allocate either no spikes or 100\% of spikes as being within bursts for any choice of parameter values, and thus the ROC curves do not span the entire range of sensitivity and specificity values. The methods were thus assessed by their minimum distance from the point of ‘perfect’ classification at (0,1), rather than the area under the ROC curve.
	\\ \\The MI method exhibited strong performance across all ages, and reached very high levels of sensitivity and specificity for a specific choice of parameter values at each age. The logISI, PS and CMA methods also had promising performance across most ages, however at P15 the PS and CMA methods exhibited higher false positive rates (Figure \ref{ROC}D). The results from the RGS method did not vary significantly as its parameter value was changed, and it was unable to reach high levels of sensitivity for any choice of parameter values. The sensitivity and specificity of the RS and IRT methods, on the other hand, spanned a range of values, however these methods were unable to reach the levels of sensitivity of the other methods. The HSMM method reached high sensitivity levels, but only at the cost of low specificity, and generally performed poorly across all ages.
	\subsection*{Evaluation of the methods} 
	Based on the assessment of the burst detectors against the desirable properties, the RS, IRT and RGS methods underperformed compared to the other methods. This was reinforced through their performance when compared to visually annotated bursts in mouse RGC recordings, where they did not reach the levels of sensitivity of the other methods in our study. These three methods were thus eliminated from any further analysis. The HSMM method had average performance on simulated data (D5--D10), however the complexity of the method's implementation meant that it was the lowest performing method on properties D1--D4. The high false positive rate of the HSMM method across all ages when analysing experimental data cemented our decision to remove this method from further consideration. 
	\subsection*{Further analysis of mouse RGC data}
	The remaining four methods, namely the PS, MI, CMA and logISI methods, were used to analyse the complete set of spike trains from each of the four control mouse RGC recordings from \citetext{Demas2003}. In this case, the parameters used for the analysis were based on those that resulted in the best performance in the ROC curves in Figure \ref{ROC}, as measured by the distance of the curve from the point of perfect classification in the top-left corner. In the original study of this data, rather than explicitly identifying spikes as being either within or between bursts, \citetext{Demas2003} used the autocorrelation of each spike train to determine the average burst duration in each recording. By explicitly identifying bursts using our four burst detectors, we were able to provide a more detailed description of the bursting activity and compare this with the authors' original results.
	\\ \\ The four burst detectors were generally in agreement about the proportion of spikes in bursts across all ages, and showed a decrease in the fraction of spikes occurring within bursts with increasing developmental age (Figure \ref{RGC_results}A). This is in agreement with the analysis of the original authors, who found that only very few spikes occurred outside of bursts at early ages, while by P15, many cells were active outside of bursts \cite{Demas2003}.
	\\ \\In terms of burst duration, all four methods showed very similar results over P9 to P13, which resemble the values found by the autocorrelogram method. However, at P15 there was a significant deviation between the results of the PS method and the other burst detectors. The MI, CMA and logISI methods followed the trend of decreasing burst duration with age, as in the original analysis, while the PS method detected a significant increase in burst duration at P15. This can be attributed to the fact that at P15 many spike trains exhibited regular `bursting episodes', periods of high activity generally spanning 10--20$\,$s that consisted of a series of shorter bursts. The PS method had a tendency to classify these bursting episodes as one long burst, while the other methods generally broke up these periods into several shorter bursts, as shown in the example spike train in Figure \ref{RGC_results}D. 
	\subsection*{Analysis of hiPSC derived neuronal network recordings}
	To further assess these methods, 409 MEA recordings from 73 hiPSC-derived neuronal networks recorded at regular intervals from two to fifteen weeks after plating (WAP) were analysed using the four best burst detectors. The MI, PS and logISI parameters used for this analysis were chosen by inspection as those that most accurately detected bursts on five randomly chosen spike trains with mean firing rate close to 1$\,$Hz, which is the minimum firing rate at which regular bursting activity tends to arise.  For the CMA method, the scale for $\alpha_1$ values from \citetext{Kapucu2012} was used, and the authors' suggestions for post hoc screening were employed, with any spike trains that were found to have average burst duration greater than 5 seconds or an average burst length above 50 spikes per burst, declared as non-bursting.  The resultant parameters used to implement each method are shown in Table \ref{param_vals_hum}.
	\\ \\ Although there were some differences in the absolute level of bursting activity detected by the different analysis methods, the results from most methods suggested a general trend of `ramping up' of bursting, in terms of burst rate and fraction of spikes in bursts, with increasing developmental age (Figure \ref{hiPSN_results}B,C). In general, however, the prevalence of bursting activity in these human network recordings tended to be significantly lower than that commonly seen in recordings of rat and mouse hippocampal or cortical networks \cite{Charlesworth2015,Chiappalone2005}. The results from some burst detectors also suggest that the prevalence of bursting activity in these networks may decrease with age after reaching a peak around 13 WAP (Figure \ref{hiPSN_results}B,C). This would be consistent with previous studies using calcium imaging of human pluripotent stem cell-derived neuronal networks, which found that bursting activity decreases at later stages of development, when it is replaced by more complex firing patterns \cite{Kirwan2015}. However, additional recordings at later time points would be required to confirm this trend in our data.
	% %Could be a result of plating density - wagenaar?
	\\ \\Unlike some previous studies of rodent neuronal networks \cite{Charlesworth2015,Demas2003}, there was no obvious relationship between burst duration and culture age in our hiPSC-derived network recordings, with bursts remaining short over the entire developmental period. Similarly, the degree of regularity of the bursting activity, captured by the coefficient of variation of interburst intervals (CV of IBI), did not appear to change significantly with increasing developmental age.
	\\ \\ To gather insight on how bursts were being detected in these recordings, visual inspection of a subset of the spike trains was performed.  Figure \ref{hiPSN_examples} shows six example spike trains at 4, 8 and 12 WAP, with the bursts detected by each method displayed. In several examples, the CMA method failed to detect numerous periods that visual inspection and the other burst detectors generally classified as bursting (Figure \ref{hiPSN_examples}C, E). This may account for the lower burst rates and proportion of spikes in bursts found by this method, compared to the other burst detectors (Figure \ref{hiPSN_results}B, C). The PS method exhibited a tendency to combine bursts that other methods detected as separate bursts, and extend bursts to incorporate additional spikes that visual inspection would suggest should not be included in bursts. This may explain the longer burst durations found by this method (Figure \ref{hiPSN_results}A). Although no method agrees perfectly with how we would assign bursts in these spike trains by visual inspection, out of the four methods examined here, on average the MI method corresponds most closely to how we would annotate bursts visually.
	\section*{DISCUSSION}
	Despite the important role of accurate burst detection in analysing neuronal network activity in a variety of contexts, a consistently widely used method for burst analysis is yet to be adopted. By examining the performance of eight burst detectors at analysing both synthetic and experimental data, we found that a number of existing methods perform poorly at identifying bursts in spike trains with a variety of properties. We identified four burst detectors that outperformed compared to other existing methods, and used these to analyse bursting activity in recordings of hiPSC-derived neuronal networks over several months of development.
	\\ \\We have shown that a number of burst detectors that were developed based on recordings from single experimental conditions do not necessarily generalise to use on other types of spike trains. For example, the RGS method, which was originally developed to analyse dopaminergic neurons, could not detect the majority of bursts in simulated spike trains, and also performed poorly at analysing experimental recordings from mouse RGCs, even when its probabilistic threshold parameter was varied over a large range. Other studies have also found issues using the RGS method to analyse changes in bursting behaviour under different drug effects \cite{Eisenman2015}. 
	\\ \\The IRT method also performed poorly at detecting bursts in a range of different spike trains. Unlike the other methods included in our study, this method was not published in a methods paper, but rather was a heuristic method designed for the analysis of a specific data set which was not spike sorted \cite{Hennig2011}, so its lack of adaptability is not surprising.
	\\ \\We have also shown that the complexity of a burst detector does not necessarily correlate with its effectiveness. The most complex method in our study, the HSMM method, often performed worse than simpler methods. Furthermore, the high computational time and non-deterministic nature of this method severely limits its ability to be scaled up for use in high-throughput analysis of MEAs, which is becoming increasing prevalent in applications such as large-scale neurotoxicity testing \cite{Nicolas2014}.
	\\ \\The performance of other methods were hindered by their underlying assumptions, such as the RS method, which has the tendency to assign approximately the same proportion of spikes as being within bursts in each spike train, regardless of how spikes are distributed. This meant that the RS method tended to both overestimate bursting activity in non-bursting trains and underestimate bursting in spike trains in which most spikes occurred within bursts, making it unsuitable for analysing MEA recordings in which the level of bursting activity does not remain consistent across all electrodes.
	\\ \\The CMA method, which was designed for the purpose of analysing recordings from developing human neuronal networks, was a promising candidate in our analysis. The major limitation of this method was its tendency to erroneously detect a large amount of bursting activity in spike trains containing no or sparse bursting activity, in particular those with non-stationary firing rates.  The authors' suggestion for post hoc screening can address this issue, but also leads to underestimation of bursting in some spike trains, as it does not allow for any shorter bursts to be identified in spike trains in which long erroneous bursts were initially detected by the CMA method. 
	\\ \\ Based on our analysis, two burst detectors showed the most promise, namely the MI and logISI methods. These methods possessed the majority of properties we deemed desirable for a burst detector and were generally able to achieve high coherence with visually detected bursts in experimental data when their parameter values were chosen optimally. These methods, however, still had limitations; the MI method requires the choice of a large number of parameters, the correct value of which can be challenging to determine, and the logISI method had a tendency to underestimate burst durations in some cases.
	\\ \\Given that we have found no `perfect' method for burst detection, our advice is to choose a burst detector based on the number of degrees of freedom the user wishes to control.
	%The MI method represents the best first choice for this purpose. 
	The MI method consistently outperformed throughout our analysis, and is our recommendation for a first choice when selecting a burst detector. Although it has a significant number of parameters to be set by the user, unlike methods with probabilistic thresholds, these parameters are easy to interpret and adjust to achieve the desired burst detection results. If appropriate parameters cannot be found for this method, a high performing alternative is the logISI method, which can be implemented without choosing any input parameters. This method is most effective when there is a clear distinction between the sizes of within-burst and between-burst intervals. 
	In cases when this distinction is not apparent, we recommend the PS and CMA methods as reasonably effective alternatives. Due to their tendency to overestimate burst durations in some circumstances, however, post hoc screening for outliers in terms of burst duration is advisable when using these methods. 
	\\ \\The most robust approach to burst detection would be to apply a number of burst detectors to the data of interest, and compare the summary statistics, such as burst rate and duration, obtained from each of the methods. %The four methods mentioned above are easily implemented, with low computational times, and thus represent a good choice for this purpose. 
	If the methods are in agreement, this provides confidence in the conclusions about the nature of bursting activity in the experimental data. Any major discrepancies between the methods can also be used to pinpoint areas where one or more burst detectors may be performing poorly, an issue that can be further investigated through visual inspection of the specific spike trains of interest. In general, we found that for spike trains that are easy to annotate using visual inspection, high performing burst detectors tend to be in close agreement. However, in spike trains for which two humans may not be able to agree on how to appropriately allocate spikes to bursts, it is likely that the methods will also disagree, and discretion is required.
	\\ \\By employing this method of applying a number of burst detection techniques to recordings of networks of hiPSC-derived neurons over a range of developmental ages, we found that bursting arises in a majority of these networks around eight to ten weeks after differentiation.  This is a similar time frame to the findings from some previous studies of human stem cell-derived neuronal networks \cite{Heikkila2009,Kirwan2015}. Additionally, although we observed some increase in bursting activity over development, the rate of this increase was far lower than that which has been commonly seen in developing rodent neuronal networks \cite{Chiappalone2005,Charlesworth2015,Wagenaar2006}.
	\\ \\One limitation of our study was the limited number of burst detectors examined. This was a deliberate choice, due to the extensive number of burst detectors available in the literature, which makes an exhaustive analysis of all methods impossible. Instead of providing a brief analysis of all burst detection methods, we restricted the scope of our study in order to provide a thorough assessment of what we saw as the most promising methods of burst detection, and to offer implementable recommendations to researchers working in this area. As an accompaniment, we also provide R code to implement all of the methods examined here.
	\\ \\The results of our study were also influenced by how the `ground truth' bursts were chosen by visual inspection in the experimental RGC recordings, which is necessarily a subjective choice. However, the relatively high degree of coherence between our visually annotated bursts and those identified by a number of burst detectors suggests that our definition of bursts was largely similar to that of other authors.
	\\ \\There are several avenues through which this work could be extended. One area that we did not explore is the possibility of improving the results of burst detection by using a pre-processing step \cite{Martens2014}. Also, during our analysis, ideas arose about how the methods under review could be improved to enhance their performance. For example, for the CMA method, restricting the allowed values for $maxISI$ to within a biologically realistic range may reduce the method's tendency to overestimate bursting in non-bursting spike trains and remove the need for post hoc screening. However, to ensure a fair and unbiased assessment of different burst detectors, we restricted our study to the original implementation of the authors' methods. Future studies in this area could look at how altering the existing methods could improve their performance. 
	\\ \\ Another area for consideration relates to which features of bursts are the most informative to extract. In past studies of rodent neuronal networks, we have shown that the temporal structure of bursting activity, measured by the CV of IBI, can be an important feature in distinguishing different types of network activity \cite{Charlesworth2015}. However, in the human network recordings examined here, we found no strong relationship between the CV of IBI and developmental age. A greater understanding of which are the most distinguishing features of bursts in human neuronal networks may inform future approaches to burst detection in these networks. 
	\pagebreak 
		\bibliographystyle{jneurosci} 
		\bibliography{Bursting.bib}
			\pagebreak 
	\listoffigures
\pagebreak	\listoftables
	\clearpage
\renewcommand{\baselinestretch}{1.4}\normalsize
		\begin{figure}[h]
			\centering
			\fbox{\includegraphics[width=176mm]{sim_egs.pdf}}
			\caption{One-minute examples of simulated spike trains for evaluating desirable features D5--D10. Scale bar represents 5$\,$s.}
			\label{sim_egs}
		\end{figure}
		\clearpage
		\begin{figure}
			\centering
			\fbox{\includegraphics[width=116mm]{rgc_eg_data.pdf}}
			\caption{Examples of one-minute spike trains from recordings of mouse retinal ganglion cell at each postnatal day. Horizontal blue bars represent bursts annotated by a human observer. Scale bar represents 5$\,$s of activity.}
			\label{RGC_eg}
		\end{figure}
		\clearpage
		\begin{figure}[h]
			\centering
			\fbox{\includegraphics[width=176mm]{des_feat_results1.pdf}}
			\caption{Fraction of spikes in bursts found by each burst detector in 100 synthetic trains with \textbf{A} No bursting (D5), \textbf{B}  No bursting and non-stationary firing rate (D6), \textbf{C} Short regular bursts (D7). Dotted line shows desired result an from ideal burst detector; methods close to this line are deemed to work well. In each 'box-and-whisker' plot, boxes show the median $\pm$ inter-quartile range (IQR), and whiskers extend to median $\pm \ 1.5\times$ IQR. Outliers are represented as points. }
			\label{sim_results1}
		\end{figure}
		\begin{figure}
			\centering
			\fbox{\includegraphics[width=176mm]{des_feat_results2.pdf}}
			\caption{Results of each burst detector at analysing 100 synthetic spike trains. \textbf{A} Fraction of spikes in bursts, and \textbf{B} Fraction of true number of bursts in spike trains with regular long bursts (D8); \textbf{C} Fraction of spikes in bursts, and \textbf{D} Fraction of true number of bursts in spike trains with high frequency bursting (D9); \textbf{E} Fraction of true positive, and \textbf{F} Fraction of false positive spikes in bursts in spike trains containing both bursting and noise (D10). Box plots and dotted line as per Figure \ref{sim_results1} legend. \textbf{B} and \textbf{D} are presented on a log-scale.}
			\label{sim_results2}
		\end{figure}	
		\begin{figure}[h]
			\centering
			%\fbox{\includegraphics[width=170mm]{paper_ROC2.pdf}}
			\fbox{\includegraphics[width=116mm]{RGC_ROC.pdf}}
			\caption{ROC curves showing the fraction of true positive (sensitivity) and false positive spikes (1-specificity) identified as being within bursts for a variety of input parameter values, for recordings of mouse retinal ganglion cells at \textbf{A} P9, \textbf{B} P11,  \textbf{C} P13 and \textbf{D} P15. The ground truth bursts for hour-long recordings of five randomly selected electrodes at each age were determined by visual inspection, examples of which are shown in Figure \ref{RGC_eg}, and the mean performance of each burst detector over the five electrodes at each age is shown.}
			\label{ROC}
		\end{figure}  
		\begin{figure}[h]
			\centering
			\fbox{\includegraphics[width=116mm]{RGC_analysis.pdf}}
			\caption{Detailed analysis of mouse retinal ganglion cell recordings. \textbf{A} Fraction of spikes in bursts, and \textbf{B} Mean burst duration found by each burst detector. Each electrode was counted as one data point in the box plots. The legend in A applies to both A and B. \textbf{C} Bursts detected by each burst detector over a 600$\,$s sample of a P15 spike train, and \textbf{D} 20$\,$s sample showing the first bursting episode from the same spike train. Horizontal bars in C and D show the bursts detected by each method. Blue bars above the spike train represent the bursts annotated by a human observer.  }
			\label{RGC_results}
		\end{figure}
		\begin{figure}[h]
			\centering
			\fbox{\includegraphics[width=116mm]{hiPSN_analysis.pdf}}
			\caption{Analysis of recordings of networks of human induced pluripotent stem cell-derived neurons. \textbf{A} Mean burst duration, \textbf{B} Bursts per minute, \textbf{C} Fraction of spikes in bursts, and \textbf{D} Coefficient of variation of interburst intervals (CV of IBI). Each data point in the box plots is the mean value across all electrodes from one recording.}
			\label{hiPSN_results}
		\end{figure}
		\begin{figure}[h]
			\centering
			\fbox{\includegraphics[width=116mm]{hiPSN_egs.pdf}}
			\caption{Results of the four burst detectors applied to 60$\,$s samples of human induced pluripotent stem cell-derived neuronal network recordings at \textbf{A, B} 4 weeks after plating (WAP), \textbf{C, D} 8 WAP, and \textbf{E, F} 12 WAP. Horizontal bars show the bursts detected by each method. Scale bar represents 5$\,$s.}
			\label{hiPSN_examples}
		\end{figure} 
		\renewcommand{\baselinestretch}{1.66}\normalsize
			\begin{table}[h]
				\centering
				\begin{tabular}{|p{5cm}|l|l|}
					\hline
					Method & Parameter & Value
					\\ \hline 
					Poisson Surprise & Minimum surprise value & $-\log(0.01) \approx 4.6$
					\\
					 \cite{Legendy1985}&&\\ 
					\hline
					MaxInterval  & Maximum beginning ISI & 0.17$\,$s
					\\ \cite{NEmanual} & Maximum end ISI & 0.3$\,$s
					\\ & Minimum interburst interval & 0.2$\,$s
					\\ & Minimum burst duration & 0.01$\,$s
					\\& Minimum spikes in a burst & 3
					\\ \hline 
					 Cumulative Moving & $\alpha_1 (\alpha_2)$ & 1.0 (0.5) if skew $<1$
					\\ Average & &  0.7 (0.5) if $1 \leq $ skew $<4$
					\\  \cite{Kapucu2012} & & 0.5 (0.9) if $4 \leq $ skew $<9$
					\\  & & 0.3 (0.1) if  $9 \leq$ skew 
					\\ \hline 
					Rank Surprise& Largest allowed ISI in burst & 75th percentile of ISIs\\
					\cite{Gourevitch2007} & Minimum surprise value& $-\log(0.01) \approx 4.6$
					\\ \hline 
				ISI Rank Threshold  & Rank threshold, $\theta_R$ & 0.5 \\
					\cite{Hennig2011} & Spike count cutoff, $\theta_C$& $C$ such that $P(C)=0.05 $
					\\ \hline
					Robust Gaussian Surprise \cite{Ko2012} & Minimum burst surprise & $-\log(0.01) \approx 4.6$
					\\ \hline    LogISI \cite{Pasquale2010} & Maximum cutoff value & 100$\,$ms
					\\ \hline
					Hidden Semi-Markov  & Probabilistic cutoff & 0.5
					\\  Model \cite{Tokdar2010}& Other parameters (N=23) & As per paper*
					\\ \hline
				\end{tabular}
				\caption{The eight burst detectors and the parameter values used for the implementation of each method on synthetic spike trains. *These parameters were left set to the default values provided in the 'burstHSMM' R package. }
				\label{param_vals}
			\end{table}
			\begin{table}[h] \centering 	
				\begin{tabular}{|l|m{13cm}|}
					\hline \multicolumn{2}{|l|}{Desirable properties}
					\\ \hline
					D1 & Deterministic: The method should detect the same bursts over repeated runs on the same  data, to ensure consistency and reproducibility of results
					\\ \hline D2 & No assumption of spike train distribution: The method should not assume ISIs follow a standard statistical  
					distribution, to ensure wide applicability to a variety of spike trains
					\\ \hline  D3 & Number of parameters: The method should have few parameters, to reduce the variability inherently introduced through parameter choice
					\\\hline D4 & Computational time: The method should run in a reasonable amount of time using standard personal computers
					\\ \hline D5 & Non-bursting trains: The method should detect few spikes as being within bursts in spike trains containing no obvious bursting behaviour
					\\\hline D6 & Non-stationary trains: The method should detect few spikes as being within bursts in spike trains with non-stationary firing rates that contain no obvious bursting behaviour 
					\\ \hline D7 & Regular short bursts: The method should detect a high proportion of spikes in bursts in spike trains containing short well-separated bursts
					\\\hline D8 & Regular long bursts: The method should detect a high proportion of spikes in bursts and accurate  number of bursts in spike trains containing long bursts with low within-burst firing rates
					\\ \hline  D9 & High frequency bursts: The method should detect a high proportion of spikes in bursts and accurate number of bursts in spike trains containing a large number of short bursts
					\\\hline D10 & Noisy train: The method should classify a high number of within-burst spikes as bursting and a low number of interburst spikes as bursting in spike trains containing both bursts and noise spikes
					\\ \hline
				\end{tabular} \caption{Desirable properties for a burst detector.}
				\label{des_prop}
			\end{table}
			\begin{table}[h] \centering \small{
					\begin{tabular}{|l|l|l|c|}
						\hline
						Spiking model & Property & Parameters & Mean \% spikes 
						\\ & & & in bursts
						\\ \hline   100 Poisson spiking &  Computational time (D4) & $\lambda$ = 1$\,$Hz & 0 
						\\ \hline  50 Poisson spiking &  Non-bursting (D5) &  $\lambda$ = 0.5$\,$Hz, $N=50$ & 0 
						\\  50 Gamma distributed ISIs & & $\alpha=1$, $\beta = 0.5$, $N=50$ & 
						\\ \hline  100 Inhomogeneous Poisson &  Non-stationary (D6) & $\lambda(t) = 1+\frac{1}{300}t$ & 0 
						\\ \hline  100 Poisson bursting &  Short bursts (D7) & $\lambda = 0.2\,$Hz, $n=5, r=0.3\,$s &  100
						\\  \hline   100 Poisson bursting & Long bursts (D8) &  $\lambda = 0.1\,$Hz, $n=18, r=3\,$s & 100 
						\\  \hline   100 Poisson bursting &  High frequency (D9) & $\lambda = 1\,$Hz, $n=10, r=0.5\,$s & 100
						\\  \hline  100 Poisson bursting with &  Noisy train (D10) & $\lambda = 0.5\,$Hz, $n=8, r=0.8\,$s & 91 
						\\   Gamma distributed noise ISIs& & $\alpha=1$, $\beta = 0.5$  & 
						\\ \hline
					\end{tabular}}
					\caption{Models and parameter values used to generate synthetic spike trains for each desirable property. Each spike train was 300$\,$s duration, and the number, $N$, of simulated trains was 100, unless otherwise stated.} \label{sim_params}
				\end{table}
				\clearpage
				\begin{table} \centering  \begin{tabular}{|l|llllllll|}
						\hline
						& PS & MI & CMA & RS & IRT & RGS & logISI & HSMM
						\\ \hline
						 D1 Deterministic & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark & $\times$
						\\ D2  Distribution assumption&  $\times$ & \checkmark & \checkmark & \checkmark & \checkmark & $\times$ & \checkmark & $\times$
						\\  D3  Number of parameters&  \checkmark & $\times$ & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark & $\times$
						\\D4  Computational time & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark & \checkmark & $\times$
						\\ \hline
					\end{tabular}
					\caption{Summary of the performance of each method on desirable properties D1--D4.} \label{des_results1}
				\end{table}
				\clearpage
				\begin{table}
					\centering \begin{tabular}{|l|llllllll|}
						\hline
						& PS & MI & CMA & RS & IRT & RGS & logISI & HSMM
						\\ \hline  D5 Non-bursting & 4 & 1 & 7 & 5 & 6 & 3 & 1 &  8
						\\D6 Non-stationary & 6 & 2 & 7 & 4 & 5 & 3 & 1 & 8 
						\\ D7 Regular bursting & 4 & 1 & 2 & 7 & 6 & 7 & 5 & 3
						\\ D8 Long bursts & 2 & 4 & 3 & 8 & 5 & 7 & 6 & 1
						\\D9 High frequency & 5 & 1 & 4 & 7 & 6 & 8 & 2 & 3
						\\ D10 Noisy bursts & 5 & 1 & 2 & 7 & 6 & 8 & 4 & 2
						\\ \hline  Total (Relative rank) & 26 (5) & 10 (1) & 25 (3) & 38 (8) & 34 (6) & 36 (7) & 19 (2) & 25 (3)
						\\ \hline
					\end{tabular}
					\caption{The relative rank of the performance of each method on desirable properties D5--D10 (1=best, 8=worst).} \label{des_results2}
				\end{table}	
				\clearpage
				\begin{table}[h]
					\centering
					\begin{tabular}{|l|l|l|}
						\hline
						Method & Parameter & Value
						\\ \hline 	
						 Poisson Surprise  & Minimum surprise value & $-\log(0.0025) \approx 6$\\ \hline 
						MaxInterval & Maximum beginning ISI & 0.2$\,$s
						\\ & Maximum end ISI & 0.3$\,$s
						\\ & Minimum interburst interval & 0.2$\,$s
						\\ & Minimum burst duration & 0.01$\,$s
						\\ & Minimum spikes in a burst & 3
						\\ \hline
						Cumulative Moving & $\alpha_1$ & 1.0 if skew $<1$
						\\ Average & &  0.7  if $1 \leq $ skew $<4$
						\\  & & 0.5  if $4 \leq $ skew $<9$
						\\  & & 0.3  if  $9 \leq$ skew 
						\\  & Maximum mean burst duration & 5$\,$s
						\\  & Maximum mean spikes per burst & 50
						\\ \hline 
						LogISI & Maximum cutoff value & 150$\,$ms
						\\ \hline
						
					\end{tabular}
					\caption{Parameter values used for burst detection on human induced pluripotent stem cell-derived neuronal networks.}
					\label{param_vals_hum}
				\end{table}	
			
		\clearpage
	\end{document}